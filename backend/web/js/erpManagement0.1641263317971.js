(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["erpManagement0"],{1589:function(t,e,a){},"1d15":function(t,e,a){"use strict";var o=a("94d9"),n=a.n(o);n.a},"1e6c":function(t,e,a){},"211c":function(t,e,a){"use strict";var o=a("43f9"),n=a.n(o);n.a},"24d8":function(t,e,a){"use strict";var o=a("27cd"),n=a.n(o);n.a},"27cd":function(t,e,a){},2887:function(t,e,a){"use strict";var o=a("4150"),n=a.n(o);n.a},"2b30":function(t,e,a){"use strict";a.r(e);var o,n,i=a("2877"),r={},s=Object(i["a"])(r,o,n,!1,null,null,null);e["default"]=s.exports},"2f21":function(t,e,a){"use strict";var o=a("79e5");t.exports=function(t,e){return!!t&&o((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},3078:function(t,e,a){"use strict";var o=a("f5a3"),n=a.n(o);n.a},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3b2b":function(t,e,a){var o=a("7726"),n=a("5dbc"),i=a("86cc").f,r=a("9093").f,s=a("aae3"),l=a("0bfb"),c=o.RegExp,d=c,u=c.prototype,f=/a/g,m=/a/g,h=new c(f)!==f;if(a("9e1e")&&(!h||a("79e5")((function(){return m[a("2b4c")("match")]=!1,c(f)!=f||c(m)==m||"/a/i"!=c(f,"i")})))){c=function(t,e){var a=this instanceof c,o=s(t),i=void 0===e;return!a&&o&&t.constructor===c&&i?t:n(h?new d(o&&!i?t.source:t,e):d((o=t instanceof c)?t.source:t,o&&i?l.call(t):e),a?this:u,c)};for(var p=function(t){t in c||i(c,t,{configurable:!0,get:function(){return d[t]},set:function(e){d[t]=e}})},g=r(d),b=0;g.length>b;)p(g[b++]);u.constructor=c,c.prototype=u,a("2aba")(o,"RegExp",c)}a("7a56")("RegExp")},4150:function(t,e,a){},"43f9":function(t,e,a){},"55dd":function(t,e,a){"use strict";var o=a("5ca1"),n=a("d8e8"),i=a("4bf8"),r=a("79e5"),s=[].sort,l=[1,2,3];o(o.P+o.F*(r((function(){l.sort(void 0)}))||!r((function(){l.sort(null)}))||!a("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(i(this)):s.call(i(this),n(t))}})},6784:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"sx"},[a("Form",{attrs:{inline:""}},[a("Row",[a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"员工姓名","label-position":"top","label-width":80}},[a("Input",{attrs:{placeholder:"请输入员工姓名"},model:{value:t.searchValidate.staffName,callback:function(e){t.$set(t.searchValidate,"staffName",e)},expression:"searchValidate.staffName"}})],1)],1),a("Col",{attrs:{xs:24,sm:24,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工单类型","label-position":"top","label-width":80}},[a("RadioGroup",{model:{value:t.searchValidate.type,callback:function(e){t.$set(t.searchValidate,"type",e)},expression:"searchValidate.type"}},[a("Radio",{attrs:{label:0}},[t._v("全部")]),a("Radio",{attrs:{label:1}},[t._v("计时")]),a("Radio",{attrs:{label:2}},[t._v("计件")]),a("Radio",{attrs:{label:3}},[t._v("休息")])],1)],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100px","text-align":"right"},attrs:{"label-width":0}},[t.showMore?t._e():a("div",{on:{click:function(e){t.showMore=!t.showMore}}},[t._v("\n              更多筛选"),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),t.showMore?a("div",{on:{click:function(e){t.showMore=!t.showMore}}},[t._v("\n              收起"),a("Icon",{attrs:{type:"ios-arrow-up"}})],1):t._e()]),a("FormItem",{attrs:{label:"","label-position":"top","label-width":0}},[a("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"default"},on:{click:function(e){return t.clear("searchValidate")}}},[t._v("重置")])],1)],1)],1),t.showMore?a("Row",[a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工单时间","label-position":"top","label-width":80}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange","split-panels":"",placement:"bottom-end",placeholder:"请选择时间"},on:{"on-change":t.handleChangeTime},model:{value:t.searchValidate.time,callback:function(e){t.$set(t.searchValidate,"time",e)},expression:"searchValidate.time"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"产品名称","label-position":"top","label-width":80}},[a("Input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.searchValidate.goodsName,callback:function(e){t.$set(t.searchValidate,"goodsName",e)},expression:"searchValidate.goodsName"}})],1)],1)],1):t._e()],1)],1),a("Card",[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.show({},"add")}}},[t._v("新增")]),a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.showExport()}}},[t._v("导出")])],1),a("Table",{attrs:{loading:t.loading,stripe:"",columns:t.tableColumns,data:t.tableData},on:{"on-selection-change":t.selectItem},scopedSlots:t._u([{key:"goodsUnit",fn:function(e){var a=e.row;return[t._v("\n        "+t._s(1===a.type?"小时":a.goodsUnit)+"\n      ")]}}])}),a("div",{staticStyle:{margin:"10px 0",overflow:"hidden","line-height":"32px"}},[a("div",{staticStyle:{float:"left"}},[a("span",[t._v("共 "+t._s(t.pageination.count)+" 条记录")]),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("第"+t._s(t.pageination.page)+"页")])]),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:Number(t.pageination.count),"page-size":Number(t.pageination.pageSize),current:Number(t.pageination.page)},on:{"on-change":t.changePage}})],1)])],1),a("addOrder",{ref:"Drawer",on:{handleSubmit:t.getData}})],1)},n=[],i=(a("8e6e"),a("456d"),a("bd86")),r=(a("ac6a"),a("c276")),s=a("b6bd"),l=r["a"].cookies.get("token"),c=a("4328");function d(t){return Object(s["a"])({url:"/staff/work-record/list?token="+l,method:"post",data:c.stringify(t)})}function u(t){return Object(s["a"])({url:"/staff/work-record/detail?token="+l,method:"post",data:t})}function f(t){return Object(s["a"])({url:"/staff/work-record/save?token="+l,method:"post",data:t})}function m(t){return Object(s["a"])({url:"/staff/work-record/del?token="+l,method:"post",data:t})}function h(t){return Object(s["a"])({url:"/staff/staff/select-info",method:"post",data:t})}var p="/staff/work-record/export?token="+l,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,title:t.formValidate.id?"编辑订单":"新增订单",width:900},on:{"on-cancel":function(e){return t.handleReset("formValidate")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":90}},[a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("工单信息")]),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工单类型"}},[a("RadioGroup",{attrs:{disabled:!!t.formValidate.id},on:{"on-change":t.changeType},model:{value:t.formValidate.type,callback:function(e){t.$set(t.formValidate,"type",e)},expression:"formValidate.type"}},[a("Radio",{attrs:{label:1,disabled:!!t.formValidate.id}},[t._v("计时")]),a("Radio",{attrs:{label:2,disabled:!!t.formValidate.id}},[t._v("计件")]),a("Radio",{attrs:{label:3,disabled:!!t.formValidate.id}},[t._v("休息")])],1)],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[3==t.formValidate.type?a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工单日期",prop:"restDate"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange",placeholder:"请选择休息日期",value:t.formValidate.restDate,format:"yyyy-MM-dd"},on:{"on-change":t.changeData}})],1):a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工单日期",prop:"date"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择工单日期",value:t.formValidate.date,format:"yyyy-MM-dd"},on:{"on-change":t.changeData}})],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[3==t.formValidate.type?a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"员工",prop:"personData"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择员工",disabled:!!t.formValidate.id,multiple:""},model:{value:t.formValidate.personData,callback:function(e){t.$set(t.formValidate,"personData",e)},expression:"formValidate.personData"}},t._l(t.staffList,(function(e,o){return a("Option",{key:e.staffId,attrs:{value:String(e.staffId)}},[t._v(t._s(e.name))])})),1)],1):a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"员工",prop:"staffId"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择员工","label-in-value":"",disabled:!!t.formValidate.id},on:{"on-change":t.changeStaff},model:{value:t.formValidate.staffId,callback:function(e){t.$set(t.formValidate,"staffId",e)},expression:"formValidate.staffId"}},t._l(t.staffList,(function(e,o){return a("Option",{key:e.staffId,attrs:{value:String(e.staffId),tag:e.wages}},[t._v(t._s(e.name))])})),1)],1)],1),2==t.formValidate.type?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"产品",prop:"goodsId"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择产品"},on:{"on-change":t.changeProduct},model:{value:t.formValidate.goodsId,callback:function(e){t.$set(t.formValidate,"goodsId",e)},expression:"formValidate.goodsId"}},t._l(t.productList,(function(e,o){return a("Option",{key:e.id,attrs:{value:String(e.id)}},[t._v(t._s(e.name+(e.attr?"("+e.attr+")":"")))])})),1)],1)],1):t._e(),2==t.formValidate.type?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工序",prop:"workingId"}},[a("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择工序","label-in-value":""},on:{"on-change":t.changeWork},model:{value:t.formValidate.workingId,callback:function(e){t.$set(t.formValidate,"workingId",e)},expression:"formValidate.workingId"}},t._l(t.workingList,(function(e,o){return a("Option",{key:e.id,attrs:{value:String(e.id),tag:e.price}},[t._v(t._s("工序"+(o+1)+" — "+e.name))])})),1)],1)],1):t._e(),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:1==t.formValidate.type?"工时":3==t.formValidate.type?"休息天数":"数量",prop:"amount"}},[a("Input",{attrs:{placeholder:"请输入"+(1==t.formValidate.type?"工时":3==t.formValidate.type?"休息天数":"数量"),type:"number",min:0},model:{value:t.formValidate.amount,callback:function(e){t.$set(t.formValidate,"amount",e)},expression:"formValidate.amount"}},[a("span",{attrs:{slot:"append"},slot:"append"},[t._v(t._s(1==t.formValidate.type?"小时":3==t.formValidate.type?"天":"件"))])])],1)],1)],1),a("Row",[3!=t.formValidate.type?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"工价",prop:"price"}},[a("Input",{attrs:{placeholder:"请输入工价",type:"number",min:0},model:{value:t.formValidate.price,callback:function(e){t.$set(t.formValidate,"price",e)},expression:"formValidate.price"}})],1)],1):t._e(),3!=t.formValidate.type?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"合计"}},[t._v("\n            "+t._s(t.totalPrice)+"\n          ")])],1):t._e(),a("Col",{attrs:{xs:24,md:24}},[a("FormItem",{attrs:{label:"备注","label-position":"top"}},[a("Input",{attrs:{maxlength:"300",type:"textarea",rows:4},model:{value:t.formValidate.remark,callback:function(e){t.$set(t.formValidate,"remark",e)},expression:"formValidate.remark"}})],1)],1)],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("Button",{staticStyle:{"margin-right":"8px"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.isSubmit},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("确定")])],1)],1)],1)},b=[],y=(a("7f7f"),a("6b54"),a("28a5"),a("3b2b"),a("2f08")),v=a("c4c8"),w=a("6c8e");function k(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function I(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?k(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var D={name:"addIandeBank",props:{modal:{type:Boolean}},components:{iCopyright:y["a"]},data:function(){var t=this,e=function(e,a,o){var n=new RegExp(/^[0-9]+$/);n.test(a);a<0?o(new Error("请输入".concat(1==t.formValidate.type?"工时":3==t.formValidate.type?"休息天数":"数量"))):3!==t.formValidate.type&&Math.floor(1e5*a+1e-6)/1e5!=a?(console.log(a,"+++++++++"),o(new Error("最多保留五位小数"))):3==t.formValidate.type&&Math.floor(100*a+1e-6)/100!=a?o(new Error("最多保留两位小数")):o()},a=function(t,e,a){e.length<1?a(new Error("请选择员工")):a()},o=function(t,e,a){e.length<1?a(new Error("请选择休息日期")):a()},n=function(t,e,a){var o=e.toString().split(".")[1]?e.toString().split(".")[1].length:0;console.log(e,o,"==============="),e<0?a(new Error("请输入正数")):o>5?a(new Error("工价请保留五位小数")):a()};return{formValidate:{status:1},ruleValidate:{date:[{required:!0,message:"请选择工单日期",trigger:"blur"}],contractCode:[{required:!0,message:"请填写合同编号",trigger:"blur"}],workingId:[{required:!0,message:"请选择工序",trigger:"change"}],staffId:[{required:!0,message:"请选择员工",trigger:"change"}],restDate:[{required:!0,message:"请选择休息日期",trigger:"change",validator:o}],personData:[{required:!0,message:"请选择员工",trigger:"change",validator:a}],goodsId:[{required:!0,message:"请选择产品",trigger:"change"}],amount:[{required:!0,type:"number",validator:e,trigger:"blur"}],price:[{validator:n,trigger:"blur"}]},showModal:!1,loading:!0,isSubmit:!1,productList:[],staffList:[],workingList:[],workPrice:"",hourPrice:""}},computed:{totalPrice:function(){var t=Object(w["b"])(this.formValidate.amount,this.formValidate.price);return t}},methods:{handleReset:function(t){this.$refs[t].resetFields(),this.showModal=!1,this.loading=!1,this.isSubmit=!1,this.$emit("hideModal")},handleSubmit:function(t){var e=this;this.isSubmit||(this.isSubmit=!0,this.$refs[t].validate((function(a){a?(3==e.formValidate.type&&(e.formValidate.date=e.formValidate.restDate[0],e.formValidate.endDate=e.formValidate.restDate[1]),f(I({},e.formValidate)).then((function(a){e.$Message.success("保存成功"),e.handleReset(t),e.$emit("handleSubmit")})).catch((function(){e.isSubmit=!1}))):e.isSubmit=!1})))},getInfo:function(t){var e=this;if(this.showModal=!0,!t)return this.formValidate={id:"",date:"",type:1,staffId:"",goodsId:"",workingId:"",amount:"",price:0,remark:"",restDate:[],personData:[]},void(this.loading=!1);this.loading=!0,u({id:t}).then((function(t){0===t.ret&&(e.formValidate=t.data.info,e.formValidate.goodsId=e.formValidate.goodsId+"",e.formValidate.staffId=e.formValidate.staffId+"",e.formValidate.workingId=e.formValidate.workingId+"",3==e.formValidate.type&&(e.formValidate.restDate=[e.formValidate.date,e.formValidate.endDate],e.formValidate.personData=[e.formValidate.staffId]),e.getProductList(),e.getWorkingList(),e.loading=!1)}))},changeData:function(t){if(3==this.formValidate.type){if(this.formValidate.restDate=t,t.length>0){var e=Date.parse(t[0]),a=Date.parse(t[1]);if(e>a)return void(this.formValidate.amount=0);if(e==a)return void(this.formValidate.amount=1);var o=(a-e)/864e5;this.formValidate.amount=o+1}}else this.formValidate.date=t},getClientList:function(){var t=this;h().then((function(e){t.staffList=e.data.select}))},changeProduct:function(){this.formValidate.workingId="",this.workingList=[],this.getWorkingList()},getWorkingList:function(){var t=this;this.formValidate.goodsId&&Object(v["d"])({goodsId:this.formValidate.goodsId}).then((function(e){t.workingList=e.data.list}))},changeWork:function(t){this.workPrice=t&&t.tag||0,2==this.formValidate.type&&(this.formValidate.price=this.workPrice)},changeStaff:function(t){this.formValidate.goodsId="",this.hourPrice=t&&t.tag||0,1==this.formValidate.type&&(this.formValidate.price=this.hourPrice),this.productList=[],this.getProductList()},getProductList:function(){var t=this;this.formValidate.staffId&&Object(v["j"])({isFinished:1,staffId:this.formValidate.staffId}).then((function(e){t.productList=e.data.list}))},changeType:function(){1==this.formValidate.type?this.formValidate.price=this.hourPrice||0:this.formValidate.price=this.workPrice||0}},mounted:function(){this.getClientList()},beforeDestroy:function(){},created:function(){}},V=D,x=(a("bdac"),a("2877")),S=Object(x["a"])(V,g,b,!1,null,"62ff63e1",null),O=S.exports;function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function M(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var j={components:{addOrder:O},data:function(){var t=this;return{loading:!0,tableColumns:[{title:"员工姓名",minWidth:100,key:"staffName"},{title:"产品名称",minWidth:100,key:"goodsName"},{title:"单位",minWidth:100,key:"goodsUnit",slot:"goodsUnit"},{title:"工序",minWidth:100,key:"workingName"},{title:"数量",key:"amount",minWidth:60},{title:"工价",minWidth:100,key:"price"},{title:"合计",minWidth:100,key:"total"},{title:"类型",minWidth:100,key:"typeName"},{title:"工单日期",minWidth:100,key:"date"},{title:"操作",key:"action",minWidth:140,render:function(e,a){return e("div",[e("Button",{props:{size:"small",type:"primary"},style:{marginRight:"5px"},on:{click:function(){t.show(a.row,"edit")}}},"编辑"),e("Button",{props:{size:"small",type:"error"},style:{marginRight:"5px"},on:{click:function(){t.del(a.row.id,"edit")}}},"删除")])}}],tableData:[],pageination:{page:1,pageSize:10,count:1},page:1,searchValidate:{staffName:"",type:0,startDate:"",endDate:"",goodsName:"",time:[]},selectIds:[],showMore:!1,workExport:p}},created:function(){this.getData()},methods:{selectItem:function(t){var e=this;this.selectIds=[],t.forEach((function(t){e.selectIds.push(t.id)}))},delBetch:function(){this.selectIds.length<1?this.$Message.error("请选择要操作的数据"):this.del(this.selectIds)},del:function(t){var e=this;console.log(1111),this.$Modal.confirm({title:"删除",content:"<p>确定删除该工单？</p>",onOk:function(){m({id:t}).then((function(t){0===t.ret?(e.$Message.success("删除成功"),e.getData()):e.$Message.error(t.msg)}))},onCancel:function(){}})},search:function(){this.page=1,this.getData()},clear:function(t){this.page=1,this.searchValidate.staffName="",this.searchValidate.goodsName="",this.searchValidate.type=0,this.searchValidate.startDate="",this.searchValidate.endDate="",this.searchValidate.time=[],this.getData()},getData:function(){var t=this;this.loading=!0,this.selectIds=[],d(M({page:this.page},this.searchValidate,{pageSize:this.pageination.pageSize})).then((function(e){t.loading=!1,0===e.ret?(console.log("成功"),t.tableData=e.data.list,t.pageination=e.data.pageInfo,sessionStorage.setItem("proportion",e.data.taxProportion)):t.$Message.error(e.msg||"接口错误")}))},changePage:function(t){this.page=t,this.getData()},show:function(t,e){console.log(t),"add"===e?this.$refs.Drawer.getInfo(""):"edit"===e&&this.$refs.Drawer.getInfo(t.id)},handleChangeTime:function(t){this.searchValidate.startDate=t[0]||"",this.searchValidate.endDate=t[1]||""},showExport:function(){var t=this.workExport+"&staffName="+this.searchValidate.staffName+"&goodsName="+this.searchValidate.goodsName+"&type="+this.searchValidate.type+"&startDate="+this.searchValidate.startDate+"&endDate="+this.searchValidate.endDate;console.log(t);var e=document.createElement("a");e.href=t,e.download=t,e.click()}}},P=j,$=(a("211c"),Object(x["a"])(P,o,n,!1,null,"0a1452bb",null));e["default"]=$.exports},"692d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"sx"},[a("Form",{attrs:{inline:""}},[a("Row",[a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"订单编号","label-position":"top","label-width":80}},[a("Input",{attrs:{placeholder:"请输入订单编号"},model:{value:t.searchValidate.number,callback:function(e){t.$set(t.searchValidate,"number",e)},expression:"searchValidate.number"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"客户","label-position":"top","label-width":80}},[a("Input",{attrs:{placeholder:"请输入客户名称"},model:{value:t.searchValidate.clientName,callback:function(e){t.$set(t.searchValidate,"clientName",e)},expression:"searchValidate.clientName"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100px","text-align":"right"},attrs:{"label-width":0}},[t.showMore?t._e():a("div",{on:{click:function(e){t.showMore=!t.showMore}}},[t._v("\n              更多筛选"),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),t.showMore?a("div",{on:{click:function(e){t.showMore=!t.showMore}}},[t._v("\n              收起"),a("Icon",{attrs:{type:"ios-arrow-up"}})],1):t._e()]),a("FormItem",{attrs:{label:"","label-position":"top","label-width":0}},[a("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"default"},on:{click:function(e){return t.clear("searchValidate")}}},[t._v("重置")])],1)],1)],1),t.showMore?a("Row",[a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"下单时间","label-position":"top","label-width":80}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange","split-panels":"",placement:"bottom-end",placeholder:"请选择时间"},on:{"on-change":t.handleChangeTime},model:{value:t.searchValidate.time,callback:function(e){t.$set(t.searchValidate,"time",e)},expression:"searchValidate.time"}})],1)],1),a("Col",{attrs:{xs:24,sm:24,md:24,lg:16}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"订单状态","label-position":"top","label-width":80}},[a("RadioGroup",{model:{value:t.searchValidate.status,callback:function(e){t.$set(t.searchValidate,"status",e)},expression:"searchValidate.status"}},[a("Radio",{attrs:{label:0}},[t._v("全部")]),a("Radio",{attrs:{label:1}},[t._v("生产中")]),a("Radio",{attrs:{label:2}},[t._v("生产完成")]),a("Radio",{attrs:{label:3}},[t._v("已发货")])],1)],1)],1)],1):t._e()],1)],1),a("Card",[a("Table",{attrs:{loading:t.loading,stripe:"",columns:t.tableColumns,data:t.tableData},on:{"on-selection-change":t.selectItem}}),a("div",{staticStyle:{margin:"10px 0",overflow:"hidden","line-height":"32px"}},[a("div",{staticStyle:{float:"left"}},[a("span",[t._v("共 "+t._s(t.pageination.count)+" 条记录")]),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("第"+t._s(t.pageination.page)+"页")])]),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:Number(t.pageination.count),"page-size":Number(t.pageination.pageSize),current:Number(t.pageination.page)},on:{"on-change":t.changePage}})],1)])],1),a("send",{ref:"Drawer",on:{getData:t.getData}}),a("materielDetail",{ref:"materielDetail"}),a("printPreview",{ref:"print"})],1)},n=[],i=(a("8e6e"),a("456d"),a("bd86")),r=(a("ac6a"),a("c5f6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{title:"打印预览",width:"900","mask-closable":!1},on:{"on-cancel":t.cancel},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading&&t.showModal?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("section",{ref:"printSub"},[a("div",{staticClass:"printer",staticStyle:{"min-heigth":"500px"},domProps:{innerHTML:t._s(t.priteInfo)}})]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.onEdit}},[t._v("编辑"+t._s(t.btnText))]),a("Button",{on:{click:t.cancel}},[t._v("关闭")]),a("Button",{attrs:{type:"primary"},on:{click:t.onPrint}},[t._v("打印")])],1)],1),a("Modal",{attrs:{title:"编辑"+t.btnText,width:"600","mask-closable":!1},on:{"on-cancel":t.cancelEdit},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[a("Form",{ref:"formValidate",attrs:{"label-width":90}},[a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{attrs:{xs:24,md:24,lg:24}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:t.btnText}},[a("Input",{attrs:{placeholder:"请输入"+t.btnText},model:{value:t.clientAddress,callback:function(e){t.clientAddress=e},expression:"clientAddress"}})],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:t.cancelEdit}},[t._v("关闭")]),a("Button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)}),s=[],l=(a("a481"),a("28a5"),a("f8b7")),c=a("7618"),d=function t(e,a){if(!(this instanceof t))return new t(e,a);this.options=this.extend({noPrint:".no-print"},a),"string"===typeof e?this.dom=document.querySelector(e):(this.isDOM(e),this.dom=this.isDOM(e)?e:e.$el),this.init()};d.prototype={init:function(){var t=this.getStyle()+this.getHtml();this.writeIframe(t)},extend:function(t,e){for(var a in e)t[a]=e[a];return t},getStyle:function(){for(var t="",e=document.querySelectorAll("style,link"),a=0;a<e.length;a++)t+=e[a].outerHTML;return t+="<style>"+(this.options.noPrint?this.options.noPrint:".no-print")+"{display:none;}</style>",t},getHtml:function(){for(var t=document.querySelectorAll("input"),e=document.querySelectorAll("textarea"),a=document.querySelectorAll("select"),o=0;o<t.length;o++)"checkbox"==t[o].type||"radio"==t[o].type?1==t[o].checked?t[o].setAttribute("checked","checked"):t[o].removeAttribute("checked"):(t[o].type,t[o].setAttribute("value",t[o].value));for(var n=0;n<e.length;n++)"textarea"==e[n].type&&(e[n].innerHTML=e[n].value);for(var i=0;i<a.length;i++)if("select-one"==a[i].type){var r=a[i].children;for(var s in r)"OPTION"==r[s].tagName&&(1==r[s].selected?r[s].setAttribute("selected","selected"):r[s].removeAttribute("selected"))}return this.dom.outerHTML},writeIframe:function(t){var e,a,o=document.createElement("iframe"),n=document.body.appendChild(o);o.id="myIframe",o.setAttribute("style","position:absolute;width:0;height:0;top:-10px;left:-10px;"),e=n.contentWindow||n.contentDocument,a=n.contentDocument||n.contentWindow.document,a.open(),a.write(t),a.close();var i=this;o.onload=function(){i.toPrint(e),setTimeout((function(){document.body.removeChild(o)}),100)}},toPrint:function(t){try{setTimeout((function(){t.focus();try{t.document.execCommand("print",!1,null)||t.print()}catch(e){t.print()}t.close()}),10)}catch(e){console.log("err",e)}},isDOM:"object"===("undefined"===typeof HTMLElement?"undefined":Object(c["a"])(HTMLElement))?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"===Object(c["a"])(t)&&1===t.nodeType&&"string"===typeof t.nodeName}};var u=d,f=a("2f08"),m={name:"addDepartment",components:{iCopyright:f["a"]},data:function(){return{orderId:"",priteInfo:"",showModal:!1,loading:!0,btnText:"",addressHtml:"",clientAddress:"",showEdit:!1}},props:{},computed:{},watch:{},methods:{infoPrite:function(t){var e=this;this.orderId=t,Object(l["h"])({orderId:t}).then((function(t){var a=t.data.info.split("</p>"),o=a.filter((function(t){return t.indexOf('class="address"')>-1}));o[0]&&(e.addressHtml=o[0]+"</p>"),e.priteInfo=t.data.info,setTimeout((function(){e.btnText=document.getElementById("cdTitle").innerHTML.replace("：",""),e.loading=!1}),500)}))},DrawerToShow:function(t){this.loading=!0,this.priteInfo="",console.log(document.getElementById("text","-----0000")),this.infoPrite(t),this.showModal=!0},cancel:function(){this.showModal=!1},onPrint:function(){var t=this,e=this;Object(l["i"])({orderId:this.orderId,clientAddress:this.clientAddress}).then((function(a){u(t.$refs.printSub),e.$print(t.$refs.printSub)}))},printView:function(){console.log(document.getElementById("priteInfoHtml"),"--内容");var t=window.open("_blank"),e=document.getElementById("priteInfoHtml").innerHTML;return t.document.write("<html><head><title>打印预览</title>"),t.document.write(e),t.document.close(),t.print(),!0},onEdit:function(){this.btnText=document.getElementById("cdTitle").innerHTML.replace("：",""),this.clientAddress=document.getElementById("cdText").innerHTML,this.showEdit=!0},cancelEdit:function(){this.clientAddress=document.getElementById("cdText").innerHTML,this.showEdit=!1},onSubmit:function(){document.getElementById("cdText").innerHTML=this.clientAddress,this.showEdit=!1}},mounted:function(){},beforeDestroy:function(){},created:function(){}},h=m,p=(a("24d8"),a("2877")),g=Object(p["a"])(h,r,s,!1,null,"727a6216",null),b=g.exports,y=a("287e"),v=a("b627");function w(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function k(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?w(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var I={components:{send:v["a"],materielDetail:y["a"],printPreview:b},data:function(){var t=this;return{loading:!0,tableColumns:[{title:"订单编号",key:"number",minWidth:100,render:function(e,a){return e("div",[e("a",{props:{type:"primary",size:"small"},style:{minWidth:"90px",display:"block",wordBreak:"break-all",paddingRight:"5px"},on:{click:function(){t.show(a.row,"edit")}}},a.row.number)])}},{title:"客户名称",minWidth:100,key:"clientName"},{title:"总金额",minWidth:100,key:"totalPrice"},{title:"已付金额",minWidth:100,key:"receiptPrice"},{title:"状态",key:"statusName",minWidth:60},{title:"下单日期",minWidth:100,key:"orderDate"},{title:"发货日期",minWidth:100,key:"sendDate"},{title:"交货日期",minWidth:100,key:"deliveryDate"},{title:"操作",key:"action",minWidth:148,render:function(e,a){return e("div",[e("Button",{props:{size:"small",type:"primary"},style:{marginRight:"5px",display:1==a.row.status||2==a.row.status?"":"none"},on:{click:function(){t.onSubmit(a.row)}}},1==a.row.status?"生产完成":2==a.row.status?"发货":""),e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px",display:Number(a.row.status)>=2?"":"none"},on:{click:function(){t.$refs.print.DrawerToShow(a.row.id)}}},"发货单")])}}],tableData:[],pageination:{page:1,pageSize:2,count:1},page:1,searchValidate:{number:"",status:0,startOrderDate:"",endOrderDate:"",clientName:"",time:[]},selectIds:[],showSend:!1,showMore:!1}},created:function(){this.getData()},methods:{onSubmit:function(t){switch(t.status){case 1:this.complete(t);break;case 2:console.log(1111),this.$refs.Drawer.getInfo(t.id,!0);break;default:this.$refs.Drawer.getInfo(t.id);break}},complete:function(t){var e=this;this.$Modal.confirm({title:"提示",content:"<p>确定该订单已生产完成吗？</p>",onOk:function(){Object(l["c"])({id:t.id}).then((function(t){0===t.ret?(e.$Message.success("提交成功"),e.getData()):e.$Message.error(t.msg)}))},onCancel:function(){}})},deliver:function(t){},selectItem:function(t){var e=this;this.selectIds=[],t.forEach((function(t){e.selectIds.push(t.id)}))},delBetch:function(){this.selectIds.length<1?this.$Message.error("请选择要操作的数据"):this.del(this.selectIds)},del:function(t){var e=this;console.log(1111),this.$Modal.confirm({title:"删除",content:"<p>确定删除该产品？</p>",onOk:function(){productDel({id:t}).then((function(t){0===t.ret?(e.$Message.success("删除成功"),e.getData()):e.$Message.error(t.msg)}))},onCancel:function(){}})},search:function(){this.page=1,this.getData()},clear:function(t){this.page=1,this.searchValidate.number="",this.searchValidate.clientName="",this.searchValidate.status=0,this.searchValidate.startOrderDate="",this.searchValidate.endOrderDate="",this.searchValidate.time=[],this.getData()},getData:function(){var t=this;this.loading=!0,this.selectIds=[],Object(l["e"])(k({page:this.page},this.searchValidate,{type:1})).then((function(e){t.loading=!1,0===e.ret?(console.log("成功"),t.tableData=e.data.list,t.pageination=e.data.pageInfo):t.$Message.error(e.msg||"接口错误")}))},changePage:function(t){this.page=t,this.getData()},show:function(t,e){"add"===e?this.$refs.Drawer.getInfo(""):"edit"===e&&this.$refs.Drawer.getInfo(t.id)},handleChangeTime:function(t){this.searchValidate.startOrderDate=t[0]||"",this.searchValidate.endOrderDate=t[1]||""}}},D=I,V=(a("1d15"),Object(p["a"])(D,o,n,!1,null,"baa73014",null));e["default"]=V.exports},"6b54":function(t,e,a){"use strict";a("3846");var o=a("cb7c"),n=a("0bfb"),i=a("9e1e"),r="toString",s=/./[r],l=function(t){a("2aba")(RegExp.prototype,r,t,!0)};a("79e5")((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?l((function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?n.call(t):void 0)})):s.name!=r&&l((function(){return s.call(this)}))},"6c8e":function(t,e,a){"use strict";function o(t){return Math.floor(t)===t}function n(t){var e={times:1,num:0};if(o(t))return e.num=t,e;var a=t+"",n=a.indexOf("."),i=a.substr(n+1).length,r=Math.pow(10,i),s=parseInt(t*r+.5,10);return e.times=r,e.num=s,e}function i(t,e,a){var o=n(t),i=n(e),r=o.num,s=i.num,l=o.times,c=i.times,d=l>c?l:c,u=null;switch(a){case"add":return u=l===c?r+s:l>c?r+s*(l/c):r*(c/l)+s,u/d;case"subtract":return u=l===c?r-s:l>c?r-s*(l/c):r*(c/l)-s,u/d;case"multiply":return u=r*s/(l*c),u;case"divide":return u=r/s*(c/l),u}}a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return s}));var r=function(t,e){return i(t,e,"add")},s=function(t,e){return console.log(t,e),i(t,e,"multiply")}},"6d61":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("div",[t._l(t.children,(function(e,o){return[e.btnIsTable?t._e():a("Button",{key:o,class:e.btnClass,attrs:{icon:"md-add",type:e.btnType?e.btnType:"default"},on:{click:function(a){return t.handleEvent(e.btnHandle,e.btnHandleParmas)}}},[t._v(t._s(e.btnTitle))])]})),a("div",{staticClass:"ivu-mt"},[a("Alert",[a("Icon",{staticClass:"ivu-mr-8",attrs:{color:"#2d8cf0",type:"ios-alert"}}),t._v("\n          已选择 "+t._s(t.selectedArr.length)+" 项\n          "),a("a",{staticClass:"ivu-ml-8",on:{click:t.clearSelectd}},[t._v("清空")])],1)],1),a("div",[a("Table",{ref:"tableData",attrs:{columns:t.columns,data:t.data,loading:t.loading},on:{"on-selection-change":t.changeSelect}})],1),a("div",{staticClass:"ivu-mt ivu-text-center"},[a("Page",{attrs:{"page-size":t.pageInfo.pageSize,total:Number(t.pageInfo.count),current:t.pageInfo.page},on:{"on-change":t.changePage}})],1)],2)]),a("addWarehouse",{ref:"addWarehouse",on:{hideModal:function(e){e&&t.getData()}}})],1)},n=[],i=(a("ac6a"),a("915b")),r=a("2f08"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,title:0==t.formValidate.houseId?"新增仓库":"编辑仓库"},on:{"on-cancel":function(e){return t.handleReset("formValidate")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"仓库名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入仓库名称"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1),a("FormItem",{attrs:{label:"仓库编号",prop:"number"}},[a("Input",{attrs:{placeholder:"请输入仓库编号"},model:{value:t.formValidate.number,callback:function(e){t.$set(t.formValidate,"number",e)},expression:"formValidate.number"}})],1),a("FormItem",{attrs:{label:"仓库保管员",prop:"keeper"}},[a("Input",{attrs:{placeholder:"请输入仓库保管员"},model:{value:t.formValidate.keeper,callback:function(e){t.$set(t.formValidate,"keeper",e)},expression:"formValidate.keeper"}})],1),a("FormItem",{attrs:{label:"仓库地址",prop:"address"}},[a("Input",{attrs:{placeholder:"请输入仓库地址"},model:{value:t.formValidate.address,callback:function(e){t.$set(t.formValidate,"address",e)},expression:"formValidate.address"}})],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("Button",{staticStyle:{"margin-right":"8px"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("确定")])],1)],1)],1)},l=[],c=(a("7f7f"),a("9411")),d={name:"addWarehouse",props:{modal:{type:Boolean,default:!1}},components:{iCopyright:r["a"]},data:function(){return{formValidate:{id:0,name:"",address:"",keeper:"",number:""},ruleValidate:{name:[{required:!0,message:"请输入仓库名称",trigger:"blur"}]},indeterminate:!1,checkAll:!1,campusList:[],showModal:!1,loading:!1}},computed:{},watch:{},methods:{loadData:function(t,e){this.showModal=!0,"add"===e?(this.formValidate={id:0,name:"",address:"",keeper:"",number:""},this.checkAll=!1):this.formValidate=t},handleCheckAll:function(){var t=this;this.indeterminate?this.checkAll=!1:this.checkAll=!this.checkAll,this.indeterminate=!1,this.checkAll?(this.formValidate.cacampusIdsmpus=[],this.campusList.forEach((function(e){t.formValidate.campusIds.push(e.sectionId+"")}))):this.formValidate.campusIds=[]},checkAllGroupChange:function(t){t.length===this.campusList.length?(this.indeterminate=!1,this.checkAll=!0):t.length>0?(this.indeterminate=!0,this.checkAll=!1):(this.indeterminate=!1,this.checkAll=!1)},handleReset:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$refs[t].resetFields(),this.showModal=!1,this.loading=!1,this.$emit("hideModal",e)},handleSubmit:function(t){var e=this;this.loading=!0,this.$refs[t].validate((function(a){a?Object(i["c"])(e.formValidate).then((function(a){e.$Message.success("保存成功"),e.handleReset(t,!0)})).catch((function(){e.loading=!1})):(e.loading=!1,e.$Message.error("请将信息填写完整"))}))},getCampusList:function(){var t=this;Object(c["E"])({}).then((function(e){t.campusList=e.data.list}))}},mounted:function(){},beforeDestroy:function(){},created:function(){}},u=d,f=(a("2887"),a("2877")),m=Object(f["a"])(u,s,l,!1,null,"6097f811",null),h=m.exports,p=h,g={name:"erpIndexPage",components:{iCopyright:r["a"],addWarehouse:p},data:function(){var t=this;return{children:[{btnTitle:"新建",btnClass:"",btnType:"primary",btnHandle:"addShow",btnHandleParams:"",btnIsTable:!1},{btnTitle:"批量删除",btnClass:"ivu-ml-8",btnType:"",btnHandle:"handleDel",btnHandleParams:"",btnIsTable:!1},{btnTitle:"编辑",btnClass:"",btnType:"primary",btnHandle:"editInfo",btnHandleParams:"",btnIsTable:!0},{btnTitle:"删除",btnClass:"",btnType:"error",btnHandle:"handleDelOne",btnHandleParams:"",btnIsTable:!0}],modal:!1,columns:[{type:"selection",minWidth:50},{title:"名称",key:"name",minWidth:100},{title:"编号",key:"number",minWidth:100},{title:"保管员",key:"keeper",minWidth:100},{title:"地址",key:"address",minWidth:100},{title:"操作",key:"action",minWidth:120,render:function(e,a){var o=[];return t.children.forEach((function(n){n.btnIsTable&&o.push(e("Button",{props:{size:"small",type:n.btnType},style:{marginRight:"10px"},on:{click:function(){t.handleEvent(n.btnHandle,a.row)}}},n.btnTitle))})),e("div",o)}}],data:[],searchValidate:{name:"",type:0},selectedArr:[],loading:!1,pageInfo:{pageSize:10,page:1,pageSum:0,count:0}}},computed:{},watch:{},methods:{editInfo:function(t){console.log(t);var e=JSON.parse(JSON.stringify(t));this.$refs.addWarehouse.loadData(e,"edit")},addShow:function(){this.modal=!0,this.$refs.addWarehouse.loadData({},"add")},resetSearch:function(){this.searchValidate={name:"",type:0},this.pageInfo={pageSize:10,page:1,pageSum:0,count:0},this.getData()},search:function(){this.pageInfo={pageSize:10,page:1,pageSum:0,count:0},this.getData()},getData:function(){var t=this;this.loading=!0,this.data=[],this.selectedArr=[],Object(i["b"])({page:this.pageInfo.page,pageSize:this.pageInfo.pageSize}).then((function(e){t.loading=!1,t.data=e.data.list,t.pageInfo=e.data.pageInfo,t.selectedArr=[]}))},changeSelect:function(t){var e=this;this.selectedArr=[],console.log(t),t.forEach((function(t){e.selectedArr.push(t.id)}))},changePage:function(t){this.pageInfo.page=t,this.getData()},clearSelectd:function(){this.$refs.tableData.selectAll(!1),this.selectedArr=[]},handleDel:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedArr;0!==e.length?this.$Modal.confirm({title:"提示",content:"<p>确认删除</p>",onOk:function(){Object(i["a"])({houseIds:e}).then((function(e){t.$Message.success("删除成功");var a=t.pageInfo.page;if(a===t.pageInfo.pageSum){var o=t.pageInfo.pageSize,n=t.pageInfo.count,i=n-o*(a-1);i===t.selectedArr.length&&(a=1===a?1:a-1)}t.changePage(a)}))},onCancel:function(){}}):this.$Message.error("请选择仓库")},handleDelOne:function(t){var e=[];e.push(t.id),this.handleDel(e)},handleEvent:function(t,e){this.$emit(t,e)}},mounted:function(){this.resetSearch()},beforeDestroy:function(){},created:function(){var t=this;this.children.forEach((function(e){t.$on(e.btnHandle,t[e.btnHandle])}))}},b=g,y=(a("3078"),Object(f["a"])(b,o,n,!1,null,"156136a4",null));e["default"]=y.exports},"856f":function(t,e,a){"use strict";var o=a("f86f"),n=a.n(o);n.a},"915b":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return r})),a.d(e,"r",(function(){return s})),a.d(e,"i",(function(){return l})),a.d(e,"f",(function(){return c})),a.d(e,"h",(function(){return d})),a.d(e,"g",(function(){return u})),a.d(e,"l",(function(){return f})),a.d(e,"j",(function(){return m})),a.d(e,"k",(function(){return h})),a.d(e,"o",(function(){return p})),a.d(e,"m",(function(){return g})),a.d(e,"n",(function(){return b})),a.d(e,"s",(function(){return y})),a.d(e,"t",(function(){return v})),a.d(e,"q",(function(){return w})),a.d(e,"d",(function(){return k})),a.d(e,"p",(function(){return I})),a.d(e,"e",(function(){return D}));var o=a("b6bd");function n(t){return Object(o["a"])({url:"/purchase/ware-house/list",method:"post",data:t})}function i(t){return Object(o["a"])({url:"/purchase/ware-house/save",method:"post",data:t})}function r(t){return Object(o["a"])({url:"/purchase/ware-house/del",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/purchase/stock/goods-list",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/purchase/goods/list-category",method:"post",data:t})}function c(t){return Object(o["a"])({url:"/purchase/goods/add-category",method:"post",data:t})}function d(t){return Object(o["a"])({url:"/purchase/goods/edit-category",method:"post",data:t})}function u(t){return Object(o["a"])({url:"/purchase/goods/del-category",method:"post",data:t})}function f(t){return Object(o["a"])({url:"/purchase/goods/list-goods",method:"post",data:t})}function m(t){return Object(o["a"])({url:"/purchase/goods/add-goods",method:"post",data:t})}function h(t){return Object(o["a"])({url:"/purchase/goods/del-goods",method:"post",data:t})}function p(t){return Object(o["a"])({url:"/purchase/stock-manage/list",method:"post",data:t})}function g(t){return Object(o["a"])({url:"/purchase/stock-manage/add",method:"post",data:t})}function b(t){return Object(o["a"])({url:"/purchase/stock-manage/detail",method:"post",data:t})}function y(t){return Object(o["a"])({url:"/purchase/stock-manage/list-query",method:"post",data:t})}function v(t){return Object(o["a"])({url:"/purchase/stock-manage/stock-statistics",method:"post",data:t})}function w(t){return Object(o["a"])({url:"/purchase/stock-manage/del",method:"post",data:t})}var k="/purchase/goods/export-goods",I="/purchase/goods/import-goods",D="/upload/template/goods.xls"},"94d9":function(t,e,a){},"98bb":function(t,e,a){},a512:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{"mask-closable":!1,title:"关联"+(1==t.formData.isFinished?"半成品":"物料"),width:1e3},on:{"on-cancel":function(e){return t.handleReset("formData")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Row",[a("Col",[a("Table",{staticStyle:{margin:"10px 0"},attrs:{columns:t.columns,data:t.formData.materialList,border:"","show-summary":"","min-height":"200"}})],1)],1),a("template",{slot:"footer"},[a("Button",{on:{click:function(e){return t.handleReset("formData")}}},[t._v("关闭")])],1)],2)},n=[],i=a("c4c8"),r={components:{},props:{},data:function(){return{loading:!1,showModal:!1,formData:{materialList:[]},columns:[{title:"名称",key:"name",minWidth:100},{title:"单位",key:"unit",minWidth:50},{title:"所需数量",minWidth:100,key:"num"}]}},computed:{},watch:{},methods:{handleReset:function(t){this.showModal=!1,this.formData.materialList=[]},getInfo:function(t){var e=this;console.log(t),this.showModal=!0,this.loading=!0,Object(i["g"])({id:t}).then((function(t){0===t.ret&&(e.formData=t.data.info,e.loading=!1)}))}},mounted:function(){},beforeDestroy:function(){},created:function(){}},s=r,l=(a("cc90"),a("2877")),c=Object(l["a"])(s,o,n,!1,null,"0b297a72",null);e["a"]=c.exports},b627:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{"mask-closable":!1,"footer-hide":!0,title:t.isSend?"发货":"订单详情",width:800},on:{"on-cancel":function(e){return t.handleReset("formValidate")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":90}},[t.isSend?a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("发货信息")]),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"发货时间",prop:"sendDate"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"请选择发货时间",value:t.formValidate.sendDate,format:"yyyy-MM-dd"},on:{"on-change":t.changeData}})],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"发货方式",prop:"sendWay"}},[a("Input",{attrs:{placeholder:"请输入发货方式"},model:{value:t.formValidate.sendWay,callback:function(e){t.$set(t.formValidate,"sendWay",e)},expression:"formValidate.sendWay"}})],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{attrs:{label:"联系人"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"请选择联系人"},model:{value:t.formValidate.clientPersonId,callback:function(e){t.$set(t.formValidate,"clientPersonId",e)},expression:"formValidate.clientPersonId"}},t._l(t.contactList,(function(e,o){return a("Option",{key:o,attrs:{value:e.personId}},[t._v(t._s(e.name+"("+e.phone+")"))])})),1)],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"收货地址",prop:"clientAddress"}},[a("Input",{attrs:{placeholder:"请输入收货地址"},model:{value:t.formValidate.clientAddress,callback:function(e){t.$set(t.formValidate,"clientAddress",e)},expression:"formValidate.clientAddress"}})],1)],1)],1):t._e(),t.formValidate.id?a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("订单信息")]),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"订单编号：",prop:"clientId"}},[t._v("\n            "+t._s(t.formValidate.number)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"状态：",prop:"clientId"}},[t._v("\n            "+t._s(t.statusName)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"订单客户：",prop:"clientId"}},[t._v("\n            "+t._s(t.formValidate.clientName)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"合同编号：",prop:"clientId"}},[t._v("\n            "+t._s(t.formValidate.contractCode)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"订单金额：",prop:"totalPrice"}},[t._v("\n            "+t._s(t.formValidate.totalPrice)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"已付金额：",prop:"receiptPrice"}},[t._v("\n            "+t._s(t.formValidate.receiptPrice)+"\n          ")])],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"交货日期：",prop:"clientId"}},[t._v("\n            "+t._s(t.formValidate.deliveryDate)+"\n          ")])],1),3==t.formValidate.status?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"发货日期：",prop:"clientId"}},[t._v("\n            "+t._s(t.formValidate.sendDate)+"\n          ")])],1):t._e()],1):t._e(),a("Row",[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("产品信息\n        ")]),a("Col",{attrs:{xs:24,md:24,lg:24}},[a("Table",{staticStyle:{margin:"10px 0"},attrs:{columns:t.columns,data:t.formValidate.detailList,border:"","show-summary":"","min-height":"200"},scopedSlots:t._u([{key:"goodsName",fn:function(e){var a=e.row;return[t._v(t._s(a.goodsName)+" "+t._s(a.workingName?"("+a.workingName+")":""))]}}])})],1)],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("Button",{staticStyle:{"margin-right":"8px"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("取消")]),t.isSend?a("Button",{attrs:{type:"primary",loading:t.isSubmit},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("确定")]):t._e()],1)],1),a("chooseMateriel",{ref:"chooseMateriel",attrs:{houseId:t.formValidate.houseId},on:{handleChoose:t.handleChoose}})],1)},n=[],i=(a("8e6e"),a("456d"),a("a481"),a("c5f6"),a("ac6a"),a("bd86")),r=(a("7f7f"),a("c276"),a("f8b7")),s=a("2f08"),l=a("d9e1"),c=(a("2f62"),a("0658"));function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f={name:"addIandeBank",props:{modal:{type:Boolean}},components:{iCopyright:s["a"],chooseMateriel:l["a"]},data:function(){return{formValidate:{status:1},ruleValidate:{sendDate:[{required:!0,message:"请选择发货时间",trigger:"blur"}],sendWay:[{required:!0,message:"请填写发货方式",trigger:"blur"}],clientAddress:[{required:!0,message:"请填写收货地址",trigger:"blur"}]},showModal:!1,columns:[{title:"名称",key:"goodsName",minWidth:100,slot:"goodsName"},{title:"规格",key:"attr",minWidth:100},{title:"单价",minWidth:100,align:"center",key:"price"},{title:"是否含税",minWidth:100,align:"center",render:function(t,e){return t("RadioGroup",{props:{value:0==e.row.isTax?"1":e.row.isTax+""}},[t("Radio",{props:{label:"1",disabled:!0}},"否"),t("Radio",{props:{label:"2",disabled:!0}},"是")])}},{title:"售价",key:"taxPrice",minWidth:50},{title:"数量",minWidth:100,align:"center",key:"num"},{title:"总价",key:"total",minWidth:50}],loading:!0,isSubmit:!1,goodsType:"",contactList:[],isSend:!1}},computed:{statusName:function(){switch(this.formValidate.status+""){case"1":return"生产中";case"2":return"生产完成";case"3":return"已发货";case"4":return"已完成";default:return""}}},methods:{handleReset:function(t){this.$refs[t].resetFields(),this.showModal=!1,this.loading=!1,this.isSubmit=!1,this.$emit("hideModal")},handleSubmit:function(t){var e=this;this.isSubmit||(this.isSubmit=!0,this.$refs[t].validate((function(a){if(a){if(e.formValidate.detailList.length<1)return e.isSubmit=!1,void e.$Message.error("请选择产品");Object(r["g"])(u({},e.formValidate)).then((function(a){e.$Message.success("保存成功"),e.handleReset(t),e.$emit("getData")})).catch((function(){e.isSubmit=!1}))}else e.isSubmit=!1})))},handleChoose:function(t){var e=this,a=this.formValidate.detailList,o=[];a.forEach((function(t){o.push(t.goodsId+"")})),t.forEach((function(t){var n={};-1===o.indexOf(t.id+"")&&(n.num=1,n.id=0,n.goodsId=t.id,n.goodsName=t.name,n.orderId=e.formValidate.id,a.push(n))})),this.formValidate.detailList=a},delGoods:function(t){this.formValidate.detailList.splice(t,1)},getInfo:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isSend=a,console.log(t),this.showModal=!0,this.loading=!0,Object(r["d"])({id:t}).then((function(t){0===t.ret&&(t.data.info.detailList=t.data.info.detailList.map((function(t){return t.total=e.onlyNumber(Number(t.num)*parseFloat(t.taxPrice)),t})),e.formValidate=t.data.info,e.formValidate.clientId=e.formValidate.clientId+"",e.formValidate.sendDate=a?"":e.formValidate.sendDate,e.formValidate.sendWay=a?"":e.formValidate.sendWay,e.formValidate.clientPersonId=a?"":e.formValidate.clientPersonId,e.getList())}))},changeData:function(t){this.formValidate.sendDate=t},getList:function(){var t=this;Object(c["l"])({clientId:this.formValidate.clientId}).then((function(e){t.loading=!1,0===e.ret?t.contactList=e.data.list:t.$Message.error(e.msg||"接口错误")}))},onlyNumber:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return console.log(t),t+="",t=t.replace(/[^\d\.]/g,""),t=t.replace(/^\./g,"0."),t=t.replace(/\.{2,}/g,"."),t=t.replace(".","$#$").replace(/\./g,"").replace("$#$","."),t=2==e?t.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"):t.replace(/^(\-)*(\d+)\.(\d{1,3}).*$/,"$1$2.$3"),parseFloat(t)}},mounted:function(){console.log(this.user),this.getList()},beforeDestroy:function(){},created:function(){}},m=f,h=(a("856f"),a("2877")),p=Object(h["a"])(m,o,n,!1,null,"808c58a2",null);e["a"]=p.exports},b7a9:function(t,e,a){},b883:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"sx"},[a("Row",[a("Col",{attrs:{xs:24,sm:24,md:24,lg:24}},[a("div",{staticStyle:{display:"flex","align-items":"flex-end"}},[a("h3",[a("a",{attrs:{href:"javascript:history.go(-1)"}},[t._v("工序管理")])]),t._v("\n            -  \n          "),a("h4",[t._v(t._s(t.productInfo.name)+"工序详情")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"default",size:"small"},on:{click:function(e){return t.back()}}},[t._v("返回")])],1)])],1)],1),a("Card",[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.show({},"add")}}},[t._v("新增")])],1),a("Table",{attrs:{loading:t.loading,stripe:"",columns:t.tableColumns,data:t.tableData},on:{"on-selection-change":t.selectItem},scopedSlots:t._u([{key:"action",fn:function(e){var o=e.row;return[a("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.show(o,"edit")}}},[t._v("编辑")]),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.del(o.id)}}},[t._v("删除")])]}}])}),a("div",{staticStyle:{margin:"10px 0",overflow:"hidden","line-height":"32px"}},[a("div",{staticStyle:{float:"left"}},[a("span",[t._v("共 "+t._s(t.pageination.count)+" 条记录")]),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("第"+t._s(t.pageination.page)+"页")])]),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:Number(t.pageination.count),"page-size":Number(t.pageination.pageSize),current:Number(t.pageination.page)},on:{"on-change":t.changePage}})],1)])],1),a("addProduct",{ref:"Drawer",on:{getData:t.getData}}),a("productMateriel",{ref:"productMateriel"})],1)},n=[],i=(a("8e6e"),a("456d"),a("7f7f"),a("bd86")),r=(a("ac6a"),a("c5f6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{"mask-closable":!1,title:(t.formData.id?"编辑":"新增")+"工序",width:1e3},on:{"on-cancel":function(e){return t.handleReset("formData")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Form",{ref:"formData",attrs:{"label-width":130,model:t.formData,rules:t.ruleInline}},[a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v(t._s(t.formData.goodsName)+" ———— 工序信息")]),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"工序名称","label-position":"top",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入工序名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1),a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{attrs:{label:"工价","label-position":"top",prop:"price"}},[a("Input",{attrs:{placeholder:"请输入工价",min:0,type:"number"},model:{value:t.formData.price,callback:function(e){t.$set(t.formData,"price",e)},expression:"formData.price"}})],1)],1),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"消耗上道工序","label-position":"top",prop:"consume"}},[a("Input",{attrs:{placeholder:"请输入消耗数量"},model:{value:t.formData.consume,callback:function(e){t.$set(t.formData,"consume",e)},expression:"formData.consume"}})],1)],1),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"工序步骤","label-position":"top",prop:"sort"}},[a("Input",{attrs:{placeholder:"请输入步骤",maxlength:11},model:{value:t.formData.sort,callback:function(e){t.$set(t.formData,"sort",e)},expression:"formData.sort"}})],1)],1),t._l(t.formData.workingList,(function(e,o){return t.formData.workingList.length>0?a("Col",{key:o,attrs:{xs:24}},[a("Col",{attrs:{xs:24,md:10}},[a("FormItem",{attrs:{label:"消耗工序:","label-position":"top",prop:"workingList."+o+".name"}},[a("Select",{on:{"on-change":function(e){return t.changePro(e,o)}},model:{value:e.goodsWorkingId,callback:function(a){t.$set(e,"goodsWorkingId",a)},expression:"item.goodsWorkingId"}},t._l(t.procedureList,(function(e,o){return a("Option",{key:o,attrs:{value:e.goodsWorkingId}},[t._v(t._s(e.workingName))])})),1)],1)],1),a("Col",{attrs:{xs:24,md:10}},[a("FormItem",{attrs:{label:"消耗数量：","label-position":"top",prop:"workingList."+o+".phone"}},[a("Input-number",{attrs:{min:1},model:{value:e.consume,callback:function(a){t.$set(e,"consume",a)},expression:"item.consume"}})],1)],1),a("Col",{attrs:{xs:24,md:4}},[a("Button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleRemove(o)}}},[t._v("删除")])],1)],1):t._e()})),a("Col",{attrs:{xs:24}},[a("FormItem",{attrs:{label:"","label-position":"top",prop:""}},[a("Button",{attrs:{type:"dashed",icon:"md-add"},on:{click:t.handleAdd}},[t._v("添加消耗工序")])],1)],1),a("Col",{attrs:{xs:24,md:24}},[a("FormItem",{attrs:{label:"备注","label-position":"top"}},[a("Input",{attrs:{maxlength:"300",type:"textarea",rows:4},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1)],1)],2),a("Row",[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("关联半成品/物料\n        "),a("div",{staticClass:"choose",on:{click:function(e){return t.$refs.chooseMateriel.loadData(2,3)}}},[a("a",[t._v("选择半成品/物料···")])])]),a("Col",[a("Table",{staticStyle:{margin:"10px 0"},attrs:{columns:t.columns,data:t.formData.relationList,border:"","show-summary":"","min-height":"200"},scopedSlots:t._u([{key:"name",fn:function(e){var a=e.row;return[t._v(t._s(a.name)+" "+t._s(a.workingName?"("+a.workingName+")":""))]}}])})],1)],1)],1),a("template",{slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset("formData")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.isSubmit},on:{click:function(e){return t.handleSubmit("formData")}}},[t._v("确定")])],1),a("chooseMateriel",{ref:"chooseMateriel",on:{handleChoose:t.handleChoose}})],2)}),s=[],l=(a("55dd"),a("3b2b"),a("5395")),c=a("c4c8"),d=a("40cb");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={components:{chooseMateriel:l["a"],uploadImg:d["a"]},props:{},data:function(){var t=this,e=(this.$createElement,function(e,a,o){var n=new RegExp(/^[0-9]+$/),i=n.test(t.formData.sort);i?o():o(new Error("排序必须为正整数"))}),a=function(e,a,o){var n=new RegExp(/^[0-9]+$/),i=n.test(t.formData.consume);i?o():o(new Error("消耗必须为正整数"))},o=function(t,e,a){var o=Math.floor(1e3*e)/1e3;console.log(e,o),e<0?a(new Error("请输入正数")):a()};return{loading:!1,showModal:!1,formData:{id:"",name:"",price:"",consume:"",goodsName:"",relationList:[],remark:"",sort:"",goodsId:"",workingList:[{consume:1,goodsWorkingId:"",goodsId:"",id:"",name:"",unit:"",workingName:"",status:1}]},ruleInline:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],number:[{required:!0,message:"编号不能为空",trigger:"blur"}],sort:[{required:!0,validator:e,trigger:"blur"}],consume:[{required:!0,validator:a,trigger:"blur"}],price:[{required:!0,validator:o,trigger:"blur"}]},isSubmit:!1,columns:[{title:"名称",key:"name",minWidth:100,slot:"name"},{title:"单位",key:"unit",minWidth:50},{title:"消耗数量",minWidth:100,align:"center",key:"consume",render:function(e,a){return e("Input",{props:{size:"small",value:a.row.consume,type:"number",min:0},on:{"on-blur":function(e){var o=Number(e.target.value);e.target.value=o,a.row.consume=o,t.formData.relationList[a.index]=a.row}}})}},{title:"操作",key:"action",minWidth:80,align:"center",render:function(e,a){return e("Icon",{attrs:{type:"md-close-circle",size:"19",title:"删除"},on:{click:function(){t.delMateriel(a.index)}}})}}],procedureList:[],a:{}}},computed:{},watch:{},methods:{handleReset:function(t){this.showModal=!1,this.isSubmit=!1,this.$refs[t].resetFields()},handleSubmit:function(t){var e=this;this.formData.workingList.map((function(t,a){t.goodsWorkingId&&0!=t.goodsWorkingId||e.formData.workingList.splice(a,1)})),this.isSubmit||this.$refs[t].validate((function(a){a?(e.isSubmit=!0,Object(c["e"])(f({},e.formData)).then((function(a){0===a.ret?(e.$Message.success("保存成功！"),e.$emit("getData"),e.handleReset(t),e.formData.workingList=[{consume:1,goodsWorkingId:"",goodsId:"",id:"",name:"",unit:"",workingName:"",status:1}]):e.$Message.error(a.msg||"接口错误")})).catch((function(t){e.isSubmit=!1,console.log(t)}))):e.$Message.error("请完善信息!")}))},getInfo:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(console.log(t),this.showModal=!0,!t){for(var i in this.formData)switch(i){case"relationList":this.formData[i]=[];break;case"workingList":this.formData[i]=[];break;default:this.formData[i]="";break}return this.formData.goodsName=n,this.formData.goodsId=a,void this.allProcedureList()}this.loading=!0,Object(c["c"])({id:t}).then((function(t){0===t.ret&&(e.formData=t.data.info,e.allProcedureList(),o&&(e.formData.id="",e.formData.attr=""),e.loading=!1)}))},allProcedureList:function(){var t=this;Object(c["a"])({goodsId:this.formData.goodsId}).then((function(e){console.log(e,"ddddddddd"),t.procedureList=e.data.data}))},handleChoose:function(t){var e=this.formData.relationList||[],a=[],o=[];console.log(11111),e.forEach((function(t){a.push(t.goodsId+""),o.push(t.goodsWorkingId+"")})),console.log(2222),t.forEach((function(t){var n={};(t.workingId?-1===o.indexOf(t.workingId+""):-1===a.indexOf(t.id+""))&&(n.consume=1,n.goodsId=t.id,n.name=t.name,n.unit=t.unit,n.id="",n.goodsWorkingId=t.workingId,n.workingName=t.workingName,e.push(n))})),console.log(this.formData),this.formData.relationList=e},delMateriel:function(t){this.formData.relationList.splice(t,1)},handleSuccess:function(t){this.formData.pic=t.pic},changePro:function(t,e){var a=this;console.log(t,e,"dddddddddddddd-----------"),this.procedureList.map((function(o){o.goodsWorkingId==t&&(a.formData.workingList[e]={consume:1,goodsWorkingId:o.goodsWorkingId,goodsId:a.formData.goodsId,id:"",name:o.name,unit:o.unit,workingName:o.workingName,status:1})})),console.log(this.formData.workingList,"workingList")},handleAdd:function(){this.formData.workingList.push({consume:1,goodsWorkingId:"",goodsId:this.formData.goodsId,id:"",name:"",unit:"",workingName:"",status:1})},handleRemove:function(t){this.formData.workingList.splice(t,1)}},mounted:function(){},beforeDestroy:function(){},created:function(){}},h=m,p=(a("e25f"),a("2877")),g=Object(p["a"])(h,r,s,!1,null,"51432328",null),b=g.exports,y=a("a512");function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function w(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var k={components:{addProduct:b,productMateriel:y["a"]},data:function(){return{loading:!0,tableColumns:[{title:"步骤",key:"isFinished",minWidth:100,render:function(t,e){return t("div","工序"+(Number(e.index)+1))}},{title:"工序名称",key:"name",minWidth:100},{title:"工价",minWidth:100,key:"price"},{title:"数量（库存）",minWidth:100,key:"stock"},{title:"排序",minWidth:60,key:"sort"},{title:"操作",key:"action",minWidth:154,slot:"action"}],tableData:[],pageination:{page:1,pageSize:10,count:1},page:1,staffData:[],formData:{name:"",isFinished:0},selectIds:[],productId:"",productInfo:{},fromPage:1}},created:function(){var t=this;this.productId=this.$route.query.id||"",this.fromPage=this.$route.query.page||1,sessionStorage.setItem("page",this.fromPage),Object(c["g"])({id:this.productId}).then((function(e){0===e.ret&&(t.productInfo=e.data.info)})),this.getData()},methods:{back:function(){this.$router.go(-1)},selectItem:function(t){var e=this;this.selectIds=[],t.forEach((function(t){e.selectIds.push(t.id)}))},delBetch:function(){this.selectIds.length<1?this.$Message.error("请选择要操作的数据"):this.del(this.selectIds)},del:function(t){var e=this;console.log(1111),this.$Modal.confirm({title:"删除",content:"<p>确定删除该工序？</p>",onOk:function(){Object(c["b"])({id:t}).then((function(t){0===t.ret?(e.$Message.success("删除成功"),e.getData()):e.$Message.error(t.msg)}))},onCancel:function(){}})},search:function(){this.page=1,this.getData(),console.log(111111),console.log(window.clipboardData)},clear:function(t){this.page=1,this.formData.name="",this.formData.isFinished=0,this.getData()},getData:function(){var t=this;this.loading=!0,this.selectIds=[],Object(c["d"])(w({page:this.page,pageSize:this.pageination.pageSize},this.formData,{type:1,goodsId:this.productId})).then((function(e){t.loading=!1,0===e.ret?(console.log("成功"),t.tableData=e.data.list,t.pageination=e.data.pageInfo):t.$Message.error(e.msg||"接口错误")}))},changePage:function(t){this.page=t,this.getData()},show:function(t,e){"add"===e?this.$refs.Drawer.getInfo("",this.productId,!1,this.productInfo.name):"edit"===e?this.$refs.Drawer.getInfo(t.id):"copy"===e&&this.$refs.Drawer.getInfo(t.id,1,!0)},toProcedure:function(t){this.$router.push({path:"procedure",query:{id:t.id}})}}},I=k,D=(a("ccca"),Object(p["a"])(I,o,n,!1,null,"17131615",null));e["default"]=D.exports},bdac:function(t,e,a){"use strict";var o=a("b7a9"),n=a.n(o);n.a},cc90:function(t,e,a){"use strict";var o=a("1589"),n=a.n(o);n.a},ccca:function(t,e,a){"use strict";var o=a("1e6c"),n=a.n(o);n.a},e25f:function(t,e,a){"use strict";var o=a("98bb"),n=a.n(o);n.a},f5a3:function(t,e,a){},f86f:function(t,e,a){}}]);