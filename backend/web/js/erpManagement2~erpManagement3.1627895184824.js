(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["erpManagement2~erpManagement3"],{"07ab":function(t,e,a){},"0933":function(t,e,a){},"138e":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"sx"},[a("Form",{ref:"formData",attrs:{model:t.formData,inline:""}},[a("Row",[a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"产品名称","label-position":"top","label-width":80}},[a("Input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"类型：","label-position":"top","label-width":80}},[a("RadioGroup",{model:{value:t.formData.isFinished,callback:function(e){t.$set(t.formData,"isFinished",e)},expression:"formData.isFinished"}},[a("Radio",{attrs:{label:0}},[t._v("全部")]),a("Radio",{attrs:{label:2}},[t._v("半成品")]),a("Radio",{attrs:{label:1}},[t._v("成品")])],1)],1)],1),a("Col",{attrs:{xs:24,sm:12,md:12,lg:8}},[a("FormItem",{attrs:{label:"","label-position":"top","label-width":80}},[a("Button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),a("Button",{staticStyle:{"margin-left":"20px"},attrs:{type:"default"},on:{click:function(e){return t.clear("formData")}}},[t._v("重置")])],1)],1)],1)],1)],1),a("Card",[a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.show({},"add")}}},[t._v("新增")]),a("Button",{staticStyle:{"margin-left":"5px"},on:{click:t.delBetch}},[t._v("批量删除")])],1),a("Table",{attrs:{loading:t.loading,stripe:"",columns:t.tableColumns,data:t.tableData},on:{"on-selection-change":t.selectItem},scopedSlots:t._u([{key:"action",fn:function(e){var o=e.row;return[a("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.show(o,"copy")}}},[t._v("复制")]),a("Dropdown",{attrs:{transfer:!0}},[a("Button",{attrs:{type:"primary",size:"small"}},[t._v("\n            更多\n            "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",[a("div",{on:{click:function(e){return t.$refs.productMateriel.getInfo(o.id)}}},[t._v("物料详情")])]),a("DropdownItem",[a("div",{on:{click:function(e){return t.toProcedure(o)}}},[t._v("工序详情")])]),a("DropdownItem",[a("div",{on:{click:function(e){return t.del(o.id)}}},[t._v("删除")])])],1)],1)]}}])}),a("div",{staticStyle:{margin:"10px 0",overflow:"hidden","line-height":"32px"}},[a("div",{staticStyle:{float:"left"}},[a("span",[t._v("共 "+t._s(t.pageination.count)+" 条记录")]),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("第"+t._s(t.pageination.page)+"页")])]),a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:Number(t.pageination.count),"page-size":Number(t.pageination.pageSize),current:Number(t.pageination.page)},on:{"on-change":t.changePage}})],1)])],1),a("addProduct",{ref:"Drawer",on:{getData:t.getData}}),a("productMateriel",{ref:"productMateriel"})],1)},r=[],i=(a("8e6e"),a("456d"),a("bd86")),n=(a("ac6a"),a("7f7f"),a("e1e1")),s=a("a512"),l=a("c4c8");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={components:{addProduct:n["a"],productMateriel:s["a"]},data:function(){var t=this;return{loading:!0,tableColumns:[{type:"selection",width:60,align:"center"},{title:"产品名称",key:"name",minWidth:100,render:function(e,a){return e("div",[e("a",{props:{type:"primary",size:"small"},style:{marginRight:"5px",width:"100px",height:"20px",display:"block"},on:{click:function(){t.show(a.row,"edit")}}},a.row.name)])}},{title:"产品规格",minWidth:100,key:"attr"},{title:"产品编号",minWidth:100,key:"number"},{title:"产品类型",key:"isFinished",minWidth:100,render:function(t,e){return t("div",1==e.row.isFinished?"成品":"半成品")}},{title:"单位",minWidth:60,key:"unit"},{title:"数量（库存）",minWidth:100,key:"stock"},{title:"操作",key:"action",minWidth:154,slot:"action"}],tableData:[],pageination:{page:1,pageSize:2,count:1},page:1,staffData:[],formData:{name:"",isFinished:0},selectIds:[]}},created:function(){this.getData()},methods:{selectItem:function(t){var e=this;this.selectIds=[],t.forEach((function(t){e.selectIds.push(t.id)}))},delBetch:function(){this.selectIds.length<1?this.$Message.error("请选择要操作的数据"):this.del(this.selectIds)},del:function(t){var e=this;console.log(1111),this.$Modal.confirm({title:"删除",content:"<p>确定删除该产品？</p>",onOk:function(){Object(l["e"])({id:t}).then((function(t){0===t.ret?(e.$Message.success("删除成功"),e.getData()):e.$Message.error(t.msg)}))},onCancel:function(){}})},search:function(){this.page=1,this.getData(),console.log(111111),console.log(window.clipboardData)},clear:function(t){this.page=1,this.formData.name="",this.formData.isFinished=0,this.getData()},getData:function(){var t=this;this.loading=!0,this.selectIds=[],Object(l["g"])(m({page:this.page},this.formData,{type:1})).then((function(e){t.loading=!1,0===e.ret?(console.log("成功"),t.tableData=e.data.list,t.pageination=e.data.pageInfo):t.$Message.error(e.msg||"接口错误")}))},changePage:function(t){this.page=t,this.getData()},show:function(t,e){"add"===e?this.$refs.Drawer.getInfo(""):"edit"===e?this.$refs.Drawer.getInfo(t.id):"copy"===e&&this.$refs.Drawer.getInfo(t.id,1,!0)},toProcedure:function(t){this.$router.push({path:"procedure",query:{id:t.id}})}}},d=u,f=(a("6846"),a("2877")),p=Object(f["a"])(d,o,r,!1,null,"30e80b4e",null);e["default"]=p.exports},1589:function(t,e,a){},6846:function(t,e,a){"use strict";var o=a("0933"),r=a.n(o);r.a},a512:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{"mask-closable":!1,title:"关联"+(1==t.formData.isFinished?"半成品":"物料"),width:1e3},on:{"on-cancel":function(e){return t.handleReset("formData")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Row",[a("Col",[a("Table",{staticStyle:{margin:"10px 0"},attrs:{columns:t.columns,data:t.formData.materialList,border:"","show-summary":"","min-height":"200"}})],1)],1),a("template",{slot:"footer"},[a("Button",{on:{click:function(e){return t.handleReset("formData")}}},[t._v("关闭")])],1)],2)},r=[],i=a("c4c8"),n={components:{},props:{},data:function(){return{loading:!1,showModal:!1,formData:{materialList:[]},columns:[{title:"名称",key:"name",minWidth:100},{title:"单位",key:"unit",minWidth:50},{title:"所需数量",minWidth:100,key:"num"}]}},computed:{},watch:{},methods:{handleReset:function(t){this.showModal=!1,this.formData.materialList=[]},getInfo:function(t){var e=this;console.log(t),this.showModal=!0,this.loading=!0,Object(i["f"])({id:t}).then((function(t){0===t.ret&&(e.formData=t.data.info,e.loading=!1)}))}},mounted:function(){},beforeDestroy:function(){},created:function(){}},s=n,l=(a("cc90"),a("2877")),c=Object(l["a"])(s,o,r,!1,null,"0b297a72",null);e["a"]=c.exports},cc90:function(t,e,a){"use strict";var o=a("1589"),r=a.n(o);r.a},e1e1:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{"mask-closable":!1,title:(t.formData.id?"编辑":"新增")+(1==t.formData.type?"产品":"物料"),width:1e3},on:{"on-cancel":function(e){return t.handleReset("formData")}},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t.loading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("Form",{ref:"formData",attrs:{"label-width":130,model:t.formData,rules:t.ruleInline}},[a("Row",{attrs:{type:"flex",justify:"start"}},[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v(t._s(1==t.formData.type?"产品":"物料")+"信息")]),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:(1==t.formData.type?"产品":"物料")+"名称","label-position":"top",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入"+(1==t.formData.type?"产品":"物料")+"名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)],1),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"编号","label-position":"top",prop:"number"}},[a("Input",{attrs:{placeholder:"请输入编号"},model:{value:t.formData.number,callback:function(e){t.$set(t.formData,"number",e)},expression:"formData.number"}})],1)],1),1==t.formData.type?a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"产品类型","label-position":"top",prop:"isFinished"}},[a("RadioGroup",{on:{"on-change":function(){t.formData.materialList=[]}},model:{value:t.formData.isFinished,callback:function(e){t.$set(t.formData,"isFinished",e)},expression:"formData.isFinished"}},[a("Radio",{attrs:{label:1,disabled:!!t.formData.id}},[t._v("成品")]),a("Radio",{attrs:{label:2,disabled:!!t.formData.id}},[t._v("半成品")])],1)],1)],1):t._e(),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"单位","label-position":"top",prop:"unit"}},[a("Input",{attrs:{placeholder:"请输入单位",maxlength:11},model:{value:t.formData.unit,callback:function(e){t.$set(t.formData,"unit",e)},expression:"formData.unit"}})],1)],1),1==t.formData.type?a("Col",{attrs:{xs:24,md:24,lg:12}},[a("FormItem",{attrs:{label:"单价","label-position":"top"}},[a("Input",{attrs:{placeholder:"请输入单价",maxlength:11},model:{value:t.formData.price,callback:function(e){t.$set(t.formData,"price",e)},expression:"formData.price"}})],1)],1):t._e(),2==t.formData.type?a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"参数","label-position":"top",prop:"parameter"}},[a("Input",{attrs:{placeholder:"请输入参数"},model:{value:t.formData.parameter,callback:function(e){t.$set(t.formData,"parameter",e)},expression:"formData.parameter"}})],1)],1):t._e(),2==t.formData.type?a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"体积","label-position":"top",prop:"volume"}},[a("Input",{attrs:{placeholder:"请输入体积"},model:{value:t.formData.volume,callback:function(e){t.$set(t.formData,"volume",e)},expression:"formData.volume"}})],1)],1):t._e(),2==t.formData.type?a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"重量","label-position":"top",prop:"weight"}},[a("Input",{attrs:{placeholder:"请输入重量"},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}})],1)],1):t._e(),1==t.formData.type?a("Col",{attrs:{xs:24,md:24}},[a("FormItem",{attrs:{label:"产品规格","label-position":"top"}},[a("Input",{attrs:{placeholder:"请输入产品规格"},model:{value:t.formData.attr,callback:function(e){t.$set(t.formData,"attr",e)},expression:"formData.attr"}})],1)],1):t._e(),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"备注","label-position":"top"}},[a("Input",{attrs:{maxlength:"300",type:"textarea",rows:4},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1)],1),a("Col",{attrs:{xs:24,md:12}},[a("FormItem",{attrs:{label:"图片","label-position":"top"}},[a("uploadImg",{attrs:{picArr:{pic:t.formData.pic||"",picName:t.formData.pic||""}},on:{uploadSuccess:t.handleSuccess}}),a("div",{staticStyle:{color:"#bbb"}},[t._v("建议尺寸：200*200px")])],1)],1)],1),1==t.formData.type&&1!=t.formData.isFinished?a("Row",[a("Col",{staticClass:"block-title",attrs:{span:"24"}},[t._v("关联"+t._s(1==t.formData.isFinished?"半成品":"物料")+"\n        "),a("div",{staticClass:"choose",on:{click:function(e){return t.$refs.chooseMateriel.loadData(1==t.formData.isFinished?2:"",1==t.formData.isFinished?1:2)}}},[a("a",[t._v("选择"+t._s(1==t.formData.isFinished?"半成品":"物料")+"···")])])]),a("Col",[a("Table",{staticStyle:{margin:"10px 0"},attrs:{columns:t.columns,data:t.formData.materialList,border:"","show-summary":"","min-height":"200"}})],1)],1):t._e()],1),a("template",{slot:"footer"},[a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset("formData")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.isSubmit},on:{click:function(e){return t.handleSubmit("formData")}}},[t._v("确定")])],1),a("chooseMateriel",{ref:"chooseMateriel",on:{handleChoose:t.handleChoose}})],2)},r=[],i=(a("8e6e"),a("456d"),a("ac6a"),a("bd86")),n=(a("7f7f"),a("c5f6"),a("d9e1")),s=a("c4c8"),l=a("40cb");function c(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?c(a,!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):c(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var u={components:{chooseMateriel:n["a"],uploadImg:l["a"]},props:{},data:function(){var t=this;this.$createElement;return{loading:!1,showModal:!1,formData:{id:"",name:"",number:"",unit:"",isFinished:1,describe:"",materialList:[],type:"",weight:"",volume:"",parameter:"",pic:"",attr:"",price:""},ruleInline:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],number:[{required:!0,message:"编号不能为空",trigger:"blur"}]},isSubmit:!1,columns:[{title:"名称",key:"name",minWidth:100},{title:"单位",key:"unit",minWidth:50},{title:"所需数量",minWidth:100,align:"center",key:"num",render:function(e,a){return e("Input",{props:{size:"small",value:a.row.num,type:"number",min:0},on:{"on-blur":function(e){var o=Number(e.target.value);e.target.value=o,a.row.num=o,t.formData.materialList[a.index]=a.row}}})}},{title:"操作",key:"action",minWidth:80,align:"center",render:function(e,a){return e("Icon",{attrs:{type:"md-close-circle",size:"19",title:"删除"},on:{click:function(){t.delMateriel(a.index)}}})}}]}},computed:{},watch:{},methods:{handleReset:function(t){this.showModal=!1,this.isSubmit=!1,this.$refs[t].resetFields()},handleSubmit:function(t){var e=this;this.isSubmit||this.$refs[t].validate((function(a){a?(e.isSubmit=!0,Object(s["h"])(m({},e.formData)).then((function(a){0===a.ret?(e.$Message.success("保存成功！"),e.$emit("getData"),e.handleReset(t)):e.$Message.error(a.msg||"接口错误")})).catch((function(t){e.isSubmit=!1,console.log(t)}))):e.$Message.error("请完善信息!")}))},getInfo:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(console.log(a,"---------"),console.log(t),this.showModal=!0,t)this.loading=!0,Object(s["f"])({id:t}).then((function(t){0===t.ret&&(e.formData=t.data.info,o&&(e.formData.id="",e.formData.attr=""),e.loading=!1)}));else{for(var r in this.formData)switch(r){case"isFinished":this.formData[r]=1;break;case"materialList":this.formData[r]=[];break;default:this.formData[r]="";break}this.formData.type=a}},handleChoose:function(t){var e=this,a=this.formData.materialList||[],o=[];console.log(11111),a.forEach((function(t){o.push(t.materialId+"")})),console.log(2222),t.forEach((function(t){var r={};-1===o.indexOf(t.id+"")&&(r.num=1,r.materialId=t.id,r.name=t.name,r.unit=t.unit,r.id="",r.goodsId=e.formData.id,a.push(r))})),console.log(this.formData),this.formData.materialList=a},delMateriel:function(t){this.formData.materialList.splice(t,1)},handleSuccess:function(t){this.formData.pic=t.pic}},mounted:function(){},beforeDestroy:function(){},created:function(){}},d=u,f=(a("f36c"),a("2877")),p=Object(f["a"])(d,o,r,!1,null,"6c835ffb",null);e["a"]=p.exports},f36c:function(t,e,a){"use strict";var o=a("07ab"),r=a.n(o);r.a}}]);